<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configura√ß√£o de Usu√°rios</title>
    <link rel="stylesheet" href="cadastro.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Navbar -->
    <header class="navbar">
      <div class="logo">ReTech</div>
      <nav>
        <a href="#">Landing Page</a>
        <a href="#">Dashboard</a>
        <a href="#">Calculadora</a>
        <a href="#">Configura√ß√µes</a>
        <a href="#" class="ativo">Cadastro</a>
      </nav>
      <div class="usuario">
        <span>Ol√° Usu√°rio üëã</span>
      </div>
    </header>

    <!-- Conte√∫do Principal -->
    <main class="container">
      <div class="card">
        <h2>Configura√ß√£o de Usu√°rios</h2>

        <div class="acoes">
          <button class="btn btn-novo" onclick="novoUsuario()">
            + Novo Usu√°rio
          </button>

          <div class="dropdown">
            <button class="btn btn-filtro" onclick="toggleFiltro()">
              <img src="Vector.png" alt="Filtro" class="icon" />
              Filtros 
              <img src="filtro.png" alt="filtro_triangulo" class="icontriangulo">
            </button>

            <div id="menuFiltro" class="menu-filtro">
              <button onclick="filtrarUsuarios('todos')">Todos</button>
              <button onclick="filtrarUsuarios('Administrador')">
                Administrador
              </button>
              <button onclick="filtrarUsuarios('Padr√£o')">Padr√£o</button>
            </div>
          </div>
 
          <button class="btn btn-editar" onclick="editarUsuario()">
            <img src="editar.png" alt="Editar" class="icon" />
            Editar
          </button>
        </div>

        <table id="tabelaUsuarios">
          <thead>
            <tr>
              <!-- checkbox para marcar/desmarcar todos -->
              <th>
                <input
                  type="checkbox"
                  id="checkAll"
                  onclick="selecionarTodos()"
                />
              </th>
              <th>Usu√°rio</th>
              <th>E-mail</th>
              <th>N√≠vel Acesso</th>
            </tr>
          </thead>
          <tbody>
            <!-- Linhas adicionadas via JS -->
          </tbody>
        </table>
      </div>
    </main>
  </body>
</html>

<script>
  var tabela = document.querySelector("#tabelaUsuarios tbody");
  var usuarios = [
    {
      nome: "Claudio Frizzarini",
      email: "Claudio@prefeituraSP.com",
      nivel: "Administrador",
    },
    {
      nome: "Julia Araripe",
      email: "Julia@prefeituraCampinas.com",
      nivel: "Padr√£o",
    },
  ];
  var filtroAtual = "todos";

  function carregarUsuarios() {
    tabela.innerHTML = "";
    var usuariosFiltrados = usuarios.filter(function (u) {
      if (filtroAtual === "todos") {
        return true;
      } else {
        return u.nivel === filtroAtual;
      }
    });

    for (var i = 0; i < usuariosFiltrados.length; i++) {
      var u = usuariosFiltrados[i];
      var originalIndex = usuarios.indexOf(u);
      tabela.innerHTML += `
            <tr>
              <td><input type="checkbox" class="checkUsuario" data-id="${originalIndex}"></td>
              <td>${u.nome}</td>
              <td>${u.email}</td>
              <td>${u.nivel}</td>
            </tr>
          `;
    }
  }

  function selecionarTodos() {
    var checkAll = document.querySelector("#checkAll");
    var checks = document.querySelectorAll(".checkUsuario");
    for (var i = 0; i < checks.length; i++) {
      checks[i].checked = checkAll.checked;
    }
  }

  function novoUsuario() {
    var nome = prompt("Digite o nome do novo usu√°rio:");
    if (!nome) return alert("Opera√ß√£o cancelada: nome obrigat√≥rio.");
    var email = prompt("Digite o e-mail:");
    if (!email) return alert("Opera√ß√£o cancelada: e-mail obrigat√≥rio.");
    var nivel = prompt("Informe o n√≠vel de acesso (Administrador / Padr√£o):");
    if (!nivel) return alert("Opera√ß√£o cancelada: n√≠vel obrigat√≥rio.");
    usuarios.push({ nome, email, nivel });
    carregarUsuarios();
    alert("‚úÖ Usu√°rio cadastrado com sucesso!");
  }

  function editarUsuario() {
    var selecionados = document.querySelectorAll(".checkUsuario:checked");
    if (selecionados.length != 1) {
      alert("‚ö†Ô∏è Selecione exatamente 1 usu√°rio para editar.");
      return;
    }
    var id = parseInt(selecionados[0].getAttribute("data-id"));
    var usuario = usuarios[id];
    var novoNome = prompt("Editar nome:", usuario.nome);
    var novoEmail = prompt("Editar e-mail:", usuario.email);
    var novoNivel = prompt("Editar n√≠vel de acesso:", usuario.nivel);
    if (!novoNome || !novoEmail || !novoNivel) {
      alert("‚ö†Ô∏è Edi√ß√£o cancelada ‚Äî todos os campos s√£o obrigat√≥rios.");
      return;
    }
    usuarios[id].nome = novoNome;
    usuarios[id].email = novoEmail;
    usuarios[id].nivel = novoNivel;
    carregarUsuarios();
    alert("Dados do usu√°rio atualizados com sucesso!");
  }

  function toggleFiltro() {
    var menu = document.getElementById("menuFiltro");
    menu.classList.toggle("mostrar");
  }

  function filtrarUsuarios(tipo) {
    filtroAtual = tipo;
    carregarUsuarios();
  }

  carregarUsuarios();
</script>
